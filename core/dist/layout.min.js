/*
 * The MIT License (MIT)
 *
 * Copyright ( c ) 2015 Teem2 LLC
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */
(function(){var t,e,n=[].slice,i={}.hasOwnProperty,r=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},s=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};e={bold:"fontWeight",bordercolor:"borderColor",borderstyle:"borderStyle",bottomborder:"borderBottomWidth",bottompadding:"paddingBottom",boxshadow:"boxShadow",bgcolor:"backgroundColor",ellipsis:"textOverflow",fontfamily:"fontFamily",fontweight:"fontWeight",fontsize:"fontSize",italic:"fontStyle",leftborder:"borderLeftWidth",leftpadding:"paddingLeft",rightborder:"borderRightWidth",rightpadding:"paddingRight",smallcaps:"fontVariant",topborder:"borderTopWidth",toppadding:"paddingTop",visible:"visibility",whitespace:"whiteSpace",x:"marginLeft",y:"marginTop",z:"z-index"},t=function(){var t,n,i,r,s;t={};for(i in e)s=e[i],t[s]=i;return n=$.style,r=function(e,i,r){var s,o;return s=t[i],null==s&&(s=t[i.replace(/-([a-z])/i,function(t){return t[1].toUpperCase()})],s=t[i]=s?s:i),s&&(o=e.$view,o[s]!==r&&o.setAttribute(s,r)),n.apply(this,arguments)},function(t){return $.style=t?r:n}}.call(this),window.dr=function(){var t,i,o,a,u,l,h,d,p,c,f,g,v,y,b,_,m,w,x,k,A,S,T,E,F,L,H,M,C,z,B,O,P,N,j,I,R,V,W,D,q,X,Y,K,U;return i=window.Node.COMMENT_NODE,I=function(){},A=function(t,e,n){return n||(n=.01),Math.abs(t-e)<n},N=function(){var t,e,i,s,o,a,u,l,h;for(e=arguments[0],a=2<=arguments.length?n.call(arguments,1):[],t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,t),e}(e),i=l=a.length-1;l>=0;i=l+=-1){o=a[i],h=o.prototype;for(u in h)s=h[u],t.prototype[u]=s}return t},P=/%$/,u=function(){var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};return t={triggerlock:null,register:function(t,e){var n,i,r,s,o;for(n=t.split(" "),this.hasOwnProperty("events")&&this.events||(this.events={}),s=0,o=n.length;o>s;s++)i=n[s],(r=this.events)[i]||(r[i]=[]),this.events[i].push(e);return this},one:function(t,e){return this.register(t,function(){return this.unregister(t,arguments.callee),e.apply(this,arguments)}),this},trigger:function(t,n,i){var r,s,o,a,u;if(s=this.hasOwnProperty("events")&&(null!=(u=this.events)?u[t]:void 0)){if(this.triggerlock){if(e.call(this.triggerlock,t)>=0)return this;this.triggerlock.push(t)}else this.triggerlock=[t];for(o=0,a=s.length;a>o;o++)r=s[o],r.call(this,n,i);return this.triggerlock=null,this}},listenTo:function(t,e,n){return t.register(e,n),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push({obj:t,ev:e,callback:n}),this},listenToOnce:function(t,e,n){var i;return i=this.listeningToOnce||(this.listeningToOnce=[]),i.push(t),t.one(e,function(){var e;return e=i.indexOf(t),-1!==e&&i.splice(e,1),n.apply(this,arguments)}),this},stopListening:function(t,e,n){var i,r,s,o,a,u,l,h,d,p,c,f,g;if(t){for(t.unregister(e,n),c=[this.listeningTo,this.listeningToOnce],a=0,h=c.length;h>a;a++)if(s=c[a])if(i=s.indexOf(t),i>-1)s.splice(i,1);else for(r=u=0,d=s.length;d>u;r=++u)if(o=s[r],t===o.obj&&e===o.ev&&n===o.callback){s.splice(r,1);break}}else{for(f=this.listeningTo,l=0,p=f.length;p>l;l++)g=f[l],t=g.obj,e=g.ev,n=g.callback,t.unregister(e,n);this.listeningTo=void 0}return this},unregister:function(t,e){var n,i,r,s,o,a,u,l,h,d;if(!t)return this.events={},this;for(i=t.split(" "),a=0,l=i.length;l>a;a++)if(o=i[a],s=null!=(d=this.events)?d[o]:void 0)if(e){for(r=u=0,h=s.length;h>u;r=++u)if(n=s[r],n===e){s=s.slice(),s.splice(r,1),this.events[o]=s;break}}else delete this.events[o];return this}}}.call(this),p=function(){var t,e,n=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};return e=["included","extended"],t=function(){function t(){}return t.include=function(t){var i,r,s;if(!t)throw new Error("include(obj) requires obj");for(i in t)r=t[i],n.call(e,i)<0&&(this.prototype[i]=r);return null!=(s=t.included)&&s.call(this,t),this},t}()}.call(this),z={parent:!0,id:!0,name:!0,"extends":!0,type:!0,scriptincludes:!0},a=function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};return t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var i;return n(e,t),e.include(u),i={number:parseFloat,"boolean":function(t){return"string"==typeof t?"true"===t:!!t},string:function(t){return t+""},json:function(t){return JSON.parse(t)},expression:function(t){return"string"!=typeof t?t:S.compile("return "+t)()},positivenumber:function(t){return t=parseFloat(t),isNaN(t)?0:Math.max(0,t)},emptynumber:function(t){return null==t||""===t?"":parseFloat(t)},size:function(t){return P.test(t)||"auto"===t?t:(t=parseFloat(t),isNaN(t)?0:Math.max(0,t))},x:function(t){var e;if(P.test(t))return t;if("string"==typeof t)switch(e=t.toLowerCase()){case"begin":case"middle":case"end":case"left":case"right":case"center":case"none":return e;default:t=parseFloat(t)}return isNaN(t)?(t=this.x,isNaN(t)?0:t):t},y:function(t){var e;if(P.test(t))return t;if("string"==typeof t)switch(e=t.toLowerCase()){case"begin":case"middle":case"end":case"top":case"bottom":case"center":case"none":return e;default:t=parseFloat(t)}return isNaN(t)?(t=this.y,isNaN(t)?0:t):t}},e.prototype._coerceType=function(t,e,n){var r;if(n||(n=this.types[t]),n){if(E||X){if(!i[n])return void V(["Invalid type '"+n+"' for attribute '"+t+"', must be one of: "+Object.keys(i).join(", ")]);try{e=i[n].call(this,e)}catch(s){r=s,V(["error parsing "+n+" value '"+e+"' for attribute '"+t+"'"])}}else e=i[n].call(this,e);"number"===n&&isNaN(e)&&(e=this[t],isNaN(e)&&(e=0))}else null==e&&(e="");return e},e.prototype.setAttribute=function(t,e,n){var i;return e=this._coerceType(t,e),n||this._unbindConstraint(t),i="set_"+t,"function"==typeof this[i]&&(e=this[i](e),e===I)?this:(t in z?this.setAndFire(t,e):this.defaultSetAttributeBehavior(t,e),this)},e.prototype.defaultSetAttributeBehavior=function(t,e){return this.setAndFire(t,e)},e.prototype.setAndFire=function(t,e){return this.sendEvent(t,this[t]=e)},e.prototype.sendEvent=function(t,e){var n;return B?void L.push({scope:this,name:t,value:e}):((null!=(n=this.events)?n[t]:void 0)&&this.trigger(t,e,this),this)},e.prototype.setAttributes=function(t){var e,n;for(e in t)n=t[e],this.setAttribute(e,n);return this},e}(p)}.call(this),x=function(){return{localStorage:function(){var t,e;e="dr";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(n){return t=n,!1}}(),touch:"ontouchstart"in window||"onmsgesturechange"in window,camelcss:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,raf:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,prefix:function(){var t,e,n;return n=window.getComputedStyle(document.documentElement,""),e=(Array.prototype.slice.call(n).join("").match(/-(moz|webkit|ms)-/)||""===n.OLink&&["","o"])[1],t="WebKit|Moz|MS|O".match(new RegExp("("+e+")","i"))[1],{dom:t,lowercase:e,css:"-"+e+"-",js:e[0].toUpperCase()+e.substr(1)}}()}}.call(this),R=window.location.search,E=R.indexOf("debug")>0,X=R.indexOf("test")>0,S=function(){var t,e,n,i,r,s,o,a,u,l,h;return o=R.indexOf("nocache")>0,u=R.indexOf("strict")>0,o||(h=x.localStorage),e="dreemcache",t=localStorage.getItem(e),h&&t&&t.length<5e6?i=JSON.parse(t):(localStorage.clear(),i={bindings:{},script:{coffee:{}}},h&&(localStorage[e]=JSON.stringify(i))),window.addEventListener("unload",function(){return h?localStorage[e]=JSON.stringify(i):void 0}),s=function(){var t,e,n;return t=i.bindings,n=null,e={MemberExpression:function(t,e){var i;return"CallExpression"===e.node.type&&"callee"===e.sub?!0:(i=t.property.name,t=t.object,n.push({binding:acorn.stringify(t),property:i}),!0)}},function(i){var r;return h&&i in t?t[i]:(r=acorn.parse(i),n=[],acorn.walkDown(r,e),t[i]=n)}}(),l=function(){var t,e;return t=i.script.coffee,e={coffee:function(e){var n;if(h&&e in t)return t[e];if(!window.CoffeeScript)return void console.warn("missing coffee-script.js include");try{if(e)return t[e]=CoffeeScript.compile(e,{bare:!0})}catch(i){return n=i,V(["error "+n+" compiling script\r\n"+e])}}},function(t,n){return null==t&&(t=""),n in e?e[n](t):t}}(),a={},r=function(t,e,n){var i,r,s,o;if(null==t&&(t=""),null==e&&(e=[]),null==n&&(n=""),i=e.join(),o=t+i+n,o in a)return a[o];try{return u&&(t='"use strict"\n'+t),s=n?new Function("return function "+n.replace("-","_")+"("+i+"){"+t+"}")():new Function(e,t),a[o]=s}catch(l){return r=l,V(["Failed to compile "+r.toString()+" "+e+" "+t])}},n=function(t,e,n){var i,r;return null==t&&(t=""),null==e&&(e=[]),null==n&&(n=""),i=e.join(),r=t+i+n,r in a?a[r]:a[r]=new Function(e,t)},{compile:E?r:n,transform:l,findBindings:s}}.call(this),T=[],B=!1,M=[],L=[],K=function(){var t,e,n,i,r,s,o,a,u,l;for(B=!1,r=0,a=M.length;a>r;r++)n=M[r],n._bindHandlers();for(M=[],s=0,u=L.length;u>s;s++)t=L[s],n=t.scope,e=t.name,i=t.value,"init"===e&&(n.inited=!0),n.sendEvent(e,i);for(L=[],o=0,l=T.length;l>o;o++)n=T[o],n._bindConstraints();return T=[]},k=function(t){var e,n,i;n={};for(e in t)i=t[e],n[e]=i;return n},U=function(t,e){var n,i,r,s,o,a,u,l,h,d;if(null!=t["with"])for(s=t["with"].split(",").reverse(),l=0,h=s.length;h>l;l++)r=s[l],i=dr[r.trim()],i&&U(i.classattributes,e);d=[];for(n in t)u=t[n],"with"!==n&&(("$methods"===n||"$types"===n)&&n in e?(e[n]=k(e[n]),d.push(function(){var t;t=[];for(o in u)a=u[o],t.push("$methods"===n&&e[n][o]?e[n][o]=e[n][o].concat(a):e[n][o]=a);return t}())):d.push("$handlers"===n&&n in e?e[n]=e[n].concat(u):e[n]=u));return d},f=function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},i=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},r=[].slice;return t=function(t){function e(t,e){var n,i,r,s,o,a,u,h,p,c,f,g,v,y;if(null==e&&(e={}),null!=e["with"]&&(null==e.$tagname&&(h=!0),u={},U(e,u),e=u,h&&delete e.$tagname),a=e.$methods)for(v=["construct","_createSprite"],p=0,f=v.length;f>p;p++)if(s=v[p],o=a[s])for(c=0,g=o.length;g>c;c++)y=o[c],r=y.method,n=y.args,i=l.test(r),d(this,s,S.compile(r,n,""+e.$tagname+"$"+s).bind(this),i);this.construct(t,e)}var s,o,u,l,h,d;return n(e,t),s=["name","parent"],o=["data","skin"],e.prototype.createChild=function(t,e){var n,i,r;return null==t&&(t={}),null==e&&(e=!1),n=null!=(r=t["class"])?r:"node",delete t["class"],"function"!=typeof dr[n]?void V(["Unrecognized class "+n+" in createChild()"]):(i=t.element,delete t.element,null==t.parent&&(t.parent=this),new dr[n](i,t,e))},e.prototype.construct=function(t,n){var r,a,u,l,h,d,p,c,f,g,v,y,b,_,m,w,x,k;if(this.subnodes=[],this.types=null!=(_=n.$types)?_:{},delete n.$types,l=n.$skiponinit,delete n.$skiponinit,r=n.$deferbindings,delete n.$deferbindings,null!=t&&(t.$view=this,n.$textcontent=t.textContent),h=n.$tagname,n.$methods&&(this.installMethods(n.$methods,h),delete n.$methods),n.$handlers){if(this.installHandlers(n.$handlers,h),"false"!==n.clickable)for(m=function(){var t,e,r,s,o;for(r=n.$handlers,o=[],t=0,e=r.length;e>t;t++)a=r[t],s=a.ev.substr(2),i.call(j,s)>=0&&o.push(a);return o}(),d=0,g=m.length;g>d;d++){a=m[d],n.clickable=!0;break}delete n.$handlers}r||this._bindHandlers(),w=function(){var t,e,i;for(i=[],t=0,e=s.length;e>t;t++)a=s[t],a in n&&i.push(a);return i}();for(p=0,v=w.length;v>p;p++)a=w[p],this.setAttribute(a,n[a]);for(x=function(){var t;t=[];for(a in n)i.call(o,a)>=0||i.call(s,a)>=0||t.push(a);return t}(),c=0,y=x.length;y>c;c++)a=x[c],this.bindAttribute(a,n[a],h);u=this.parent,u&&u instanceof e&&(u.sendEvent("subnodes",this),u.doSubnodeAdded(this)),k=function(){var t,e,i;for(i=[],e=0,t=o.length;t>e;e++)a=o[e],a in n&&i.push(a);return i}();for(f=0,b=k.length;b>f;f++)a=k[f],this.bindAttribute(a,n[a],h);return this.constraints&&T.push(this),l||this.inited?void 0:this.initialize()},e.prototype.initialize=function(t){return B||(this.inited=!0),t?void 0:this.sendEvent("init",this)},l=/this.super\(|this\["super"\]\(/,e.prototype.installMethods=function(t,e,n,i){var r,s,o,a,u,h,p,c,f;null==n&&(n=this),null==i&&(i=this);for(h in t)for(u=t[h],p=0,c=u.length;c>p;p++)f=u[p],a=f.method,s=f.args,r=f.allocation,"construct"!==h&&"_createSprite"!==h&&(o=l.test(a),d(n,h,S.compile(a,s,""+e+"$"+h).bind(i),o,r))},e.prototype.installHandlers=function(t,e,n){var i,r,s,o,a,u,l,d,p,c;for(null==n&&(n=this),null==this.handlers&&(this.handlers=[]),p=0,c=t.length;c>p;p++)s=t[p],r=s.ev,u=s.name,d=s.script,i=s.args,l=s.reference,a=s.method,r=r.substr(2),s.callback=a?n[a]:h(r,d,n,e,i),o={scope:this,ev:r,name:u,callback:s.callback,reference:l},this.handlers.push(o)},e.prototype.removeHandlers=function(t,e,n){var i,r,s,o,a,u,l,h,d,p;for(null==n&&(n=this),d=0,p=t.length;p>d;d++)s=t[d],r=s.ev,a=s.name,h=s.script,i=s.args,u=s.reference,o=s.method,r=r.substr(2),null!=u?(l=this._valueLookup(u)(),n.stopListening(l,r,s.callback)):n.unregister(r,s.callback)},u=/\${(.+)}/,e.prototype.bindAttribute=function(t,e,n){var i,r,s;return"string"==typeof e&&(i=e.match(u))?this.setConstraint(t,i[1],!0):(r=t.match(O))?(t=r[1],s={scope:this,ev:t,callback:h(t,e,this,n)},this.handlers.push(s)):this.setAttribute(t,e)},h=function(t,e,n,i,r){var s;return null==i&&(i=""),null==r&&(r=["value"]),s=S.compile(e,r,""+i+"$on"+t),function(){var e;return e=arguments.length?arguments:t in n?[n[t]]:[],s.apply(n,e)}},d=function(t,e,n,i){var s,o;return i?(e in t&&"function"==typeof t[e]&&(o=t[e],s=!0),t[e]=function(){var e,i,a,u;return e=1<=arguments.length?r.call(arguments,0):[],i=t.hasOwnProperty("super"),i&&(a=t["super"]),t["super"]=s?function(){var n,i,s;for(s=1<=arguments.length?r.call(arguments,0):[],n=s.length,i=e.splice(0);n;)i[--n]=s[n];return o.apply(t,i)}:I,u=n.apply(t,e),i?t["super"]=a:delete t["super"],u}):t[e]=n},e.prototype.setConstraint=function(t,e,n){var i,r,s,o,a,u;for(null!=this.constraints?this._unbindConstraint(t):this.constraints={},this.constraints[t]={expression:e,bindings:{}},r=this.constraints[t].bindings,o=S.findBindings(e),a=0,u=o.length;u>a;a++)s=o[a],i=s.binding,null==r[i]&&(r[i]=[]),r[i].push(s);n||this._bindConstraints()},e.prototype._valueLookup=function(t){return S.compile("return "+t).bind(this)},e.prototype._unbindConstraint=function(t){var e,n,i,r,s,o,a,u,l;if(this.constraints&&(null!=(u=this.constraints[t])?u.callback:void 0)){for(l=this.constraints[t],e=l.callback,n=l.callbackbindings,i=o=0,a=n.length;a>o;i=o+=2)r=n[i],s=n[i+1],s.unregister(r,e);this.constraints[t]=null}},e.prototype._bindConstraints=function(){var t,e,n,i,r,s,o,u,l,h,d,p,c;c=this.constraints;for(l in c){s=c[l],i=s.bindings,o=s.expression,null==s.callbackbindings&&(s.callbackbindings=[]),u=this._valueLookup(o),s.callback=this._constraintCallback(l,u);for(t in i)if(n=i[t],r=this._valueLookup(t)())for(r instanceof a||console.log("Binding to non-Eventable "+t+" of constraint "+o+" for "+this.$tagname+(this.id?"#"+this.id:this.name?"."+l:"")),d=0,p=n.length;p>d;d++)e=n[d],h=e.property,r instanceof a&&r.register(h,s.callback),s.callbackbindings.push(h,r);else V(["Could not bind to "+t+" of constraint "+o+" for "+this.$tagname+(this.id?"#"+this.id:this.name?"."+l:"")]);this.setAttribute(l,u(),!0)}},e.prototype._bindHandlers=function(t){var e,n,i,r,s,o,u,l,h,d;if(this.handlers){if(B)return void M.push(this);for(d=this.handlers,l=0,h=d.length;h>l;l++)e=d[l],u=e.scope,r=e.name,i=e.ev,n=e.callback,s=e.reference,s?(o=this._valueLookup(s)(),o instanceof a&&(u.listenTo(o,i,n),t&&i in o&&n(o[i]))):(u.register(i,n),t&&i in u&&n(u[i]));this.handlers=[]}},e.prototype._constraintCallback=function(t,e){return function(){this.setAttribute(t,e(),!0)}.bind(this)},e.prototype.set_parent=function(t){return t instanceof e&&(this.name&&(t[this.name]=this),t.subnodes.push(this)),t},e.prototype.set_name=function(t){return this.parent&&t&&(this.parent[t]=this),t},e.prototype.set_id=function(t){return window[t]=this,t},e.prototype.animate=function(t,e){var n,i,r,s,o,a,u;null==e&&(e=600),r={};for(o in t)u=t[o],a={motion:"bret",control:[.01]},a[0]=this[o]||0,a[e]=u,n=Animator.createAnimator(),n.playStateless(a),r[o]=n;return s=void 0,i=function(t){return function(e){var a,u,l;if(!t.destroyed){null==s&&(s=e),u=e-s,a=!1;for(o in r)n=r[o],l=n.timestep(u),t.setAttribute(o,l),n.ended&&(a=!0);return a?void 0:dr.idle.callOnIdle(i)}}}(this),dr.idle.callOnIdle(i),this},e.prototype._removeFromParent=function(t){var e,n,i;this.parent&&(e=this.parent[t],n=e.indexOf(this),-1!==n&&(i=e[n],e.splice(n,1),this.parent.sendEvent(t,i),"subnodes"===t&&this.parent.doSubnodeRemoved(i)))},e.prototype._findParents=function(t,e){var n,i;for(n=[],i=this;i;)t in i&&i[t]===e&&n.push(i),i=i.parent;return n},e.prototype._findInParents=function(t){var e;for(e=this.parent;e;){if(t in e)return e[t];e=e.parent}},e.prototype.doSubnodeAdded=function(){},e.prototype.doSubnodeRemoved=function(){},e.prototype.destroy=function(t){var e,n,i,r,s,o;if(this.destroyed=!0,this.sendEvent("destroy",this),this.constraints)for(e in this.constraints)this._unbindConstraint(e);for(this.listeningTo&&this.stopListening(),this.unregister(),(null!=(s=this.parent)?s[this.name]:void 0)===this&&delete this.parent[this.name],o=this.subnodes,i=0,r=o.length;r>i;i++)n=o[i],null!=n&&n.destroy(!0);return t?void 0:this._removeFromParent("subnodes")},e}(a)}.call(this),v=function(){var t,n,i,r,s,o,a=function(t,e){return function(){return t.apply(e,arguments)}},u=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};return t=function(){function t(t,e,n){null==n&&(n="div"),this._handleScroll=a(this._handleScroll,this),null==t?(this.el=document.createElement(n),this.el.$init=!0):t instanceof HTMLElement&&(this.el=t),this.el.$view=e,this.css_baseclass="sprite",this._updateClass()}return t.prototype.setAttribute=function(t,e){var n;switch(t){case"width":case"height":case"z":case"opacity":case"bgcolor":case"color":case"whitespace":case"fontsize":case"fontfamily":case"fontweight":case"text-transform":case"boxshadow":case"leftpadding":case"rightpadding":case"toppadding":case"bottompadding":case"leftborder":case"rightborder":case"topborder":case"bottomborder":case"bordercolor":case"borderstyle":return this.setStyle(t,e);case"bold":return this.setStyle(t,e?"bold":"normal");case"italic":return this.setStyle(t,e?"italic":"normal");case"smallcaps":return this.setStyle(t,e?"small-caps":"normal");case"ellipsis":return this.__ellipsis=e,this.setStyle(t,e?"ellipsis":"clip"),this.__updateOverflow();case"perspective":case"transform-style":case"transform-origin":case"transform":return this.setStyle(x.prefix.css+t,e);default:if(n=this.el.$view._declaredTypes,null==n[t])return this.setStyle(t,e)}},t.prototype.setStyle=function(t){return t?function(t,n,i,r){var s,o;return null==r&&(r=this.el),null==n&&(n=""),t in e&&(t=e[t]),r.style[t]=n,"borderTopWidth"===t||"paddingTop"===t?(s=(this.__BP_TOGGLE=!this.__BP_TOGGLE)?-.001:.001,o=r.style.paddingLeft,r.style.paddingLeft=Number(o.substring(0,o.length-2))+s+"px"):void 0}:function(t,n,i,r){return null==r&&(r=this.el),null==n&&(n=""),t in e&&(t=e[t]),r.style[t]=n}}("WebKit"===x.prefix.dom),t.prototype.set_parent=function(e){return e instanceof t&&(e=e.el),this.el.parentNode!==e?e.appendChild(this.el):void 0},t.prototype.set_id=function(t){return this.el.setAttribute("id",t)},t.prototype._cursorVal=function(){return this.__clickable?this.__cursor||"pointer":""},t.prototype.set_scrollx=function(t){return this.el.scrollLeft!==t?this.el.scrollLeft=t:void 0},t.prototype.set_scrolly=function(t){return this.el.scrollTop!==t?this.el.scrollTop=t:void 0},t.prototype.set_cursor=function(t){return this.__cursor=t,this.setStyle("cursor",this._cursorVal(),!0)},t.prototype.set_visible=function(t){var e,n,i,r;return t?(e=null,n=this.el.$view,i=n.x,r=n.y):(e="hidden",i=r=-1e5),this.setStyle("visibility",e,!0),this.setStyle("marginLeft",i,!0),this.setStyle("marginTop",r,!0)},t.prototype.set_x=function(t){return this.el.$view.visible?this.setStyle("marginLeft",t,!0):void 0},t.prototype.set_y=function(t){return this.el.$view.visible?this.setStyle("marginTop",t,!0):void 0},t.prototype.set_clickable=function(t){return this.__clickable=t,this.__updatePointerEvents(),this.setStyle("cursor",this._cursorVal(),!0)},t.prototype.set_clip=function(t){return this.__clip=t,this.__updateOverflow()},t.prototype.set_scrollable=function(t){return this.__scrollable=t,this.__updateOverflow(),this.__updatePointerEvents(),t?$(this.el).on("scroll",this._handleScroll):$(this.el).off("scroll",this._handleScroll)},t.prototype.set_scrollbars=function(t){return this.__scrollbars=t,this._updateClass()},t.prototype._handleScroll=function(t){var e,n,i,r,s,o;return e=t.target,r=e.$view,r&&(s=e.scrollLeft,o=e.scrollTop,r.scrollx!==s&&r.setAttribute("scrollx",s),r.scrolly!==o&&r.setAttribute("scrolly",o),i=this._lastScrollEvent,n={scrollx:s,scrolly:o,scrollwidth:e.scrollWidth,scrollheight:e.scrollHeight},!i||i.scrollx!==n.scrollx||i.scrolly!==n.scrolly||i.scrollwidth!==n.scrollwidth||i.scrollheight!==n.scrollheight)?(r.sendEvent("scroll",n),this._lastScrollEvent=n):void 0},t.prototype.__updateOverflow=function(){return this.setStyle("overflow",this.__scrollable?"auto":this.__clip||this.__ellipsis?"hidden":"",!0)},t.prototype.__updatePointerEvents=function(){return this.setStyle("pointer-events",this.__clickable||this.__scrollable?"auto":"",!0)},t.prototype.destroy=function(){return this.el.parentNode.removeChild(this.el),this.input&&(this.input=this.input.$view=null),this.el=this.jqel=this.el.$view=null},t.prototype.setInnerHTML=function(t){return this.el.innerHTML=t},t.prototype.setText=function(t){var e,n,i,r,s;if(null!=t){for(s=this.el.childNodes,i=0,r=s.length;r>i;i++)e=s[i],e&&3===e.nodeType&&this.el.removeChild(e);return n=document.createTextNode(t),this.el.appendChild(n)}},t.prototype.getText=function(){var t,e;for(t=this.el.firstChild,e=[];t;)3===t.nodeType&&e.push(t.data.trim()),t=t.nextSibling;return e.join("")},t.prototype.getInnerHTML=function(){return this.el.innerHTML},t.prototype.value=function(t){return this.input?null!=t?this.input.value=t:this.input.value:void 0},t.prototype.handle=function(t){var e;return(e=t.target.$view)?e.sendEvent(t.type,e):void 0},t.prototype.createTextElement=function(){return this.css_baseclass="sprite sprite-text noselect",this._updateClass()},t.prototype.createInputtextElement=function(t,e,n,i){var r;return this.css_baseclass="sprite noselect",this._updateClass(),e?r=document.createElement("textarea"):(r=document.createElement("input"),r.setAttribute("type","text")),r.$init=!0,r.setAttribute("value",t),r.setAttribute("class","sprite-inputtext"),n&&this.setStyle("width",n,!0,r),i&&this.setStyle("height",i,!0,r),this.setStyle("color","inherit",!1,r),this.setStyle("background","inherit",!1,r),this.setStyle("font-variant","inherit",!1,r),this.setStyle("font-style","inherit",!1,r),this.setStyle("font-weight","inherit",!1,r),this.setStyle("font-size","inherit",!1,r),this.setStyle("font-family","inherit",!1,r),this.el.appendChild(r),r.$view=this.el.$view,$(r).on("focus blur",this.handle),this.input=r},t.prototype.getBounds=function(){return this.el.getBoundingClientRect()},t.prototype.getAbsolute=function(){var t;return null==this.jqel&&(this.jqel=$(this.el)),t=this.jqel.offset(),{x:t.left-window.pageXOffset,y:t.top-window.pageYOffset}},t.prototype.set_class=function(t){return null==t&&(t=""),this.__classname=t,this._updateClass()},t.prototype._updateClass=function(){var t;return t=this.css_baseclass,this.__classname&&(t+=" "+this.__classname),this.__scrollbars||(t+=" noscrollbar"),this.el.setAttribute("class",t)},t}(),x.camelcss&&(s=t.prototype.setStyle,n=function(t,e){return e.toUpperCase()},r=/-([\da-z])/gi,t.prototype.setStyle=function(t,e,i,o){return null==o&&(o=this.el),t.match(r)&&(t=t.replace(r,n)),s(t,e,i,o)}),E&&(i=["width","height","background-color","opacity","padding","transform","transform-style","transform-origin","z-index","perspective","cursor",x.prefix.css+"transform",x.prefix.css+"transform-style",x.prefix.css+"transform-origin"],o=t.prototype.setStyle,t.prototype.setStyle=function(t,n,r,s){return null==s&&(s=this.el),"$instanceattributes"!==t?(r||t in e||u.call(i,t)>=0||console.warn("Setting unknown CSS property "+t+" = "+n+" on ",this.el.$view,e,r),o(t,n,r,s)):void 0}),t}.call(this),_=function(){var e,n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};return e=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return i(n,e),n.prototype.construct=function(t,e){var i,r,s,o;this.subviews=[],s={border:"positivenumber",borderstyle:"string",bottomborder:"positivenumber",bottompadding:"positivenumber","class":"string",clickable:"boolean",clip:"boolean",cursor:"string",height:"size",ignorelayout:"json",layouthint:"json",leftborder:"positivenumber",leftpadding:"positivenumber",opacity:"number",padding:"positivenumber",rightborder:"positivenumber",rightpadding:"positivenumber",rotation:"number",scrollable:"boolean",scrollbars:"boolean",scrollx:"number",scrolly:"number",skin:"string",topborder:"positivenumber",toppadding:"positivenumber",visible:"boolean",width:"size",x:"x",xanchor:"string",xscale:"number",y:"y",yanchor:"string",yscale:"number",z:"number",zanchor:"number",$tagname:"string",$textcontent:"string"},o=e.$types;for(i in o)r=o[i],s[i]=r;return this._declaredTypes=e.$types=s,this.__fullBorderPaddingWidth=this.__fullBorderPaddingHeight=0,this.xanchor=this.yanchor="center",this.cursor="pointer",this.bgcolor=this.bordercolor="transparent",this.borderstyle="solid",this.skin="",this.leftborder=this.rightborder=this.topborder=this.bottomborder=this.border=this.leftpadding=this.rightpadding=this.toppadding=this.bottompadding=this.padding=this.x=this.y=this.width=this.height=this.innerwidth=this.innerheight=this.boundsxdiff=this.boundsydiff=this.boundsx=this.boundsy=this.boundswidth=this.boundsheight=this.zanchor=this.scrollx=this.scrolly=0,this.opacity=1,this.clip=this.scrollable=this.clickable=this.isaligned=this.isvaligned=this.ignorelayout=this.scrollbars=!1,this.visible=!0,this._createSprite(t,e),n.__super__.construct.apply(this,arguments)},n.prototype.initialize=function(){return this.__autoLayoutwidth&&this.__autoLayoutwidth.setAttribute("locked",!1),this.__autoLayoutheight&&this.__autoLayoutheight.setAttribute("locked",!1),this.__updateBounds(),n.__super__.initialize.apply(this,arguments)},n.prototype._createSprite=function(t,e){return this.sprite=new v(t,this,e.$tagname)},n.prototype.destroy=function(t){return n.__super__.destroy.apply(this,arguments),t||this._removeFromParent("subviews"),this.sprite.destroy(),this.sprite=null},n.prototype.defaultSetAttributeBehavior=function(t,e){var i;return i=this[t],n.__super__.defaultSetAttributeBehavior.apply(this,arguments),e=this[t],i!==e?this.sprite.setAttribute(t,e):void 0},n.prototype.getBoundsRelativeToParent=function(){var t,e,n,i,r,s,o,a;return r=this.xanchor,a=this.yanchor,e=this.width,t=this.height,r="left"===r?0:"center"===r?e/2:"right"===r?e:Number(r),a="top"===a?0:"center"===a?t/2:"bottom"===a?t:Number(a),n=this.x,i=n+e,s=this.y,o=s+t,new g([n,s,i,s,i,o,n,o]).transformAroundOrigin(this.xscale,this.yscale,this.rotation,r+n,a+s).getBoundingBox()},n.prototype.__updateBounds=function(){var t,e,n,i,r,s,o;return this.__boundsAreDifferent?(t=this.getBoundsRelativeToParent(),n=t.width,e=t.height,i=t.x,s=t.y,r=this.x-i,o=this.y-s):(i=this.x,s=this.y,r=o=0,n=this.width,e=this.height),A(this.boundsx,i)||this.setAndFire("boundsx",i),A(this.boundsy,s)||this.setAndFire("boundsy",s),A(this.boundswidth,n)||this.setAndFire("boundswidth",n),A(this.boundsheight,e)||this.setAndFire("boundsheight",e),A(this.boundsxdiff,r)||this.setAndFire("boundsxdiff",r),A(this.boundsydiff,o)?void 0:this.setAndFire("boundsydiff",o)},n.prototype.__setupAlignConstraint=function(t,e){var n,i,r,s,o,a,u,l,h,d,p;if(a="__alignFunc"+t,("string"==typeof e||this[a])&&(d=this.parent,d instanceof f&&("x"===t?(u=!0,i="innerwidth",r="boundsxdiff",s="boundswidth",n="isaligned"):(u=!1,i="innerheight",r="boundsydiff",s="boundsheight",n="isvaligned"),h=this[a],h&&(this.stopListening(d,i,h),this.stopListening(this,r,h),this.stopListening(this,s,h),delete this[a],this[n]&&this.setAndFire(n,!1)),"string"==typeof e))){if(l=e.toLowerCase(),p=this,"begin"===l||u&&"left"===l||!u&&"top"===l)o=this[a]=function(){var e;return e=p[r],p[t]!==e?(p.__noSpecialValueHandling=!0,p.setAttribute(t,e)):void 0},o.autoOk=!0;else if("middle"===l||"center"===l)o=this[a]=function(){return p.__noSpecialValueHandling=!0,p.setAttribute(t,(d[i]-p[s])/2+p[r])},this.listenTo(d,i,o),this.listenTo(this,s,o);else if("end"===l||u&&"right"===l||!u&&"bottom"===l)o=this[a]=function(){return p.__noSpecialValueHandling=!0,p.setAttribute(t,d[i]-p[s]+p[r])},this.listenTo(d,i,o),this.listenTo(this,s,o);else if("none"===l)return!0;return o?(this.listenTo(this,r,o),o.call(),this[n]||this.setAndFire(n,!0),!0):void 0}},n.prototype.__setupAutoConstraint=function(e,n,i){var r,s;return r="__autoLayout"+e,"auto"===n||this[r]?(s=this[r],s&&(s.destroy(),delete this[r]),"auto"===n?(this[r]=new t(null,{parent:this,axis:i,locked:this.inited?"false":"true"}),this.inited||(this.__noSpecialValueHandling=!0,this.setAttribute(e,0)),!0):void 0):void 0},n.prototype.__setupPercentConstraint=function(t,e,n){var i,r,s,o,a,u;return r="__percentFunc"+t,"string"==typeof e||this[r]?(s=this[r],o=this.parent,o instanceof f||(o=dr.window,n=n.substring(5)),s&&(this.stopListening(o,n,s),delete this[r]),P.test(e)?(u=this,a=parseInt(e)/100,i=this[r]=function(){return u.__noSpecialValueHandling=!0,u.setAttribute(t,o[n]*a)},this.listenTo(o,n,i),i.call(),!0):void 0):void 0},n.prototype.set_parent=function(t){var e;return e=n.__super__.set_parent.apply(this,arguments),t instanceof n&&(t.subviews.push(this),t.sendEvent("subviews",this),t=t.sprite),this.sprite.set_parent(t),e},n.prototype.set_id=function(t){var e;return e=n.__super__.set_id.apply(this,arguments),this.sprite.set_id(t),e},n.prototype.set_class=function(t){return this["class"]!==t&&(this.sprite.set_class(t),this.setAndFire("class",t)),I},n.prototype.set_clip=function(t){return this.clip!==t&&(this.sprite.set_clip(t),this.setAndFire("clip",t)),I},n.prototype.set_scrollable=function(t){return this.scrollable!==t&&(this.sprite.set_scrollable(t),this.setAndFire("scrollable",t)),I},n.prototype.set_scrollbars=function(t){return this.scrollbars!==t&&(this.sprite.set_scrollbars(t),this.setAndFire("scrollbars",t)),I},n.prototype.set_scrollx=function(t){return t=isNaN(t)?0:Math.max(0,Math.min(this.sprite.el.scrollWidth-this.width+this.leftborder+this.rightborder,t)),this.scrollx!==t&&(this.sprite.set_scrollx(t),this.setAndFire("scrollx",t)),I},n.prototype.set_scrolly=function(t){return t=isNaN(t)?0:Math.max(0,Math.min(this.sprite.el.scrollHeight-this.height+this.topborder+this.bottomborder,t)),this.scrolly!==t&&(this.sprite.set_scrolly(t),this.setAndFire("scrolly",t)),I},n.prototype.set_visible=function(t){return this.visible!==t&&(this.sprite.set_visible(t),this.setAndFire("visible",t)),I},n.prototype.set_bgcolor=function(t){return this.bgcolor!==t&&(this.sprite.setAttribute("bgcolor",t),this.setAndFire("bgcolor",t)),I},n.prototype.set_x=function(t){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("x",t,"innerwidth"))return I;if(this.__setupAlignConstraint("x",t))return I}return this.x!==t&&(this.sprite.set_x(t),this.__boundsAreDifferent&&t-this.boundsxdiff!==this.boundsx&&this.sendEvent("boundsx",this.boundsx=t-this.boundsxdiff),this.setAndFire("x",t),this.inited&&this.__updateBounds()),I
},n.prototype.set_y=function(t){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("y",t,"innerheight"))return I;if(this.__setupAlignConstraint("y",t))return I}return this.y!==t&&(this.sprite.set_y(t),this.__boundsAreDifferent&&t-this.boundsydiff!==this.boundsy&&this.sendEvent("boundsy",this.boundsy=t-this.boundsydiff),this.setAndFire("y",t),this.inited&&this.__updateBounds()),I},n.prototype.set_width=function(t,e){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("width",t,"innerwidth"))return I;if(this.__setupAutoConstraint("width",t,"x"))return I}return t=Math.max(t,this.__fullBorderPaddingWidth),this.width!==t&&(e||this.sprite.setAttribute("width",t),this.setAndFire("innerwidth",t-this.__fullBorderPaddingWidth),this.setAndFire("width",t),this.inited&&this.__updateBounds()),I},n.prototype.set_height=function(t,e){if(this.__noSpecialValueHandling)this.__noSpecialValueHandling=!1;else{if(this.__setupPercentConstraint("height",t,"innerheight"))return I;if(this.__setupAutoConstraint("height",t,"y"))return I}return t=Math.max(t,this.__fullBorderPaddingHeight),this.height!==t&&(e||this.sprite.setAttribute("height",t),this.setAndFire("innerheight",t-this.__fullBorderPaddingHeight),this.setAndFire("height",t),this.inited&&this.__updateBounds()),I},n.prototype.set_border=function(t){return this.__lockBPRecalc=!0,this.setAttribute("topborder",t),this.setAttribute("bottomborder",t),this.setAttribute("leftborder",t),this.setAttribute("rightborder",t),this.__lockBPRecalc=!1,this.setAndFire("border",t),this.__updateInnerWidth(),this.__updateInnerHeight(),I},n.prototype.set_topborder=function(t){return this.sprite.setAttribute("topborder",t),this.setAndFire("topborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerHeight()),I},n.prototype.set_bottomborder=function(t){return this.sprite.setAttribute("bottomborder",t),this.setAndFire("bottomborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerHeight()),I},n.prototype.set_leftborder=function(t){return this.sprite.setAttribute("leftborder",t),this.setAndFire("leftborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerWidth()),I},n.prototype.set_rightborder=function(t){return this.sprite.setAttribute("rightborder",t),this.setAndFire("rightborder",t),this.__lockBPRecalc||(this.__updateBorder(),this.__updateInnerWidth()),I},n.prototype.__updateBorder=function(){var t;return t=this.topborder,this.bottomborder===t&&this.leftborder===t&&this.rightborder===t?this.setAndFire("border",t):null!=this.border?this.setAndFire("border",void 0):void 0},n.prototype.set_padding=function(t){return this.__lockBPRecalc=!0,this.setAttribute("toppadding",t),this.setAttribute("bottompadding",t),this.setAttribute("leftpadding",t),this.setAttribute("rightpadding",t),this.__lockBPRecalc=!1,this.setAndFire("padding",t),this.__updateInnerWidth(),this.__updateInnerHeight(),I},n.prototype.set_toppadding=function(t){return this.sprite.setAttribute("toppadding",t),this.setAndFire("toppadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerHeight()),I},n.prototype.set_bottompadding=function(t){return this.sprite.setAttribute("bottompadding",t),this.setAndFire("bottompadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerHeight()),I},n.prototype.set_leftpadding=function(t){return this.sprite.setAttribute("leftpadding",t),this.setAndFire("leftpadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerWidth()),I},n.prototype.set_rightpadding=function(t){return this.sprite.setAttribute("rightpadding",t),this.setAndFire("rightpadding",t),this.__lockBPRecalc||(this.__updatePadding(),this.__updateInnerWidth()),I},n.prototype.__updatePadding=function(){var t;return t=this.toppadding,this.bottompadding===t&&this.leftpadding===t&&this.rightpadding===t?this.setAndFire("padding",t):null!=this.padding?this.setAndFire("padding",void 0):void 0},n.prototype.__updateInnerWidth=function(){var t;return this.__fullBorderPaddingWidth=t=this.leftborder+this.rightborder+this.leftpadding+this.rightpadding,t>this.width&&(this.__noSpecialValueHandling=!0,this.setAttribute("width",t,!0)),this.setAndFire("innerwidth",this.width-t)},n.prototype.__updateInnerHeight=function(){var t;return this.__fullBorderPaddingHeight=t=this.topborder+this.bottomborder+this.toppadding+this.bottompadding,t>this.height&&(this.__noSpecialValueHandling=!0,this.setAttribute("height",t,!0)),this.setAndFire("innerheight",this.height-t)},n.prototype.set_clickable=function(t){return this.clickable!==t&&(this.sprite.set_clickable(t),this.setAndFire("clickable",t)),I},n.prototype.set_cursor=function(t){return this.cursor!==t&&(this.sprite.set_cursor(t),this.setAndFire("cursor",t)),I},n.prototype.__updateTransform=function(){var t,e,n,i,r;return t="",n=this.xscale,null==this.xscale&&(n=this.xscale=1),r=this.yscale,null==this.yscale&&(r=this.yscale=1),(1!==n||1!==r)&&(t+="scale3d("+n+","+r+",1.0)"),this.rotation||(this.rotation=0),this.rotation%360!==0&&(t+=" rotate3d(0,0,1.0,"+this.rotation+"deg)"),this.__boundsAreDifferent=""!==t,this.z||(this.z=0),0!==this.z&&(t+=" translate3d(0,0,"+this.z+"px)",this.parent.sprite.setAttribute("transform-style","preserve-3d")),""!==t&&(e=this.xanchor,"left"!==e&&"right"!==e&&"center"!==e&&(e+="px"),i=this.yanchor,"top"!==i&&"bottom"!==i&&"center"!==i&&(i+="px"),this.sprite.setAttribute("transform-origin",e+" "+i+" "+this.zanchor+"px")),this.sprite.setAttribute("transform",t)},n.prototype.set_perspective=function(t){return"0"===t?"none":t+"px"},n.prototype.set_xscale=function(t){return t!==this.xscale&&(this.setAndFire("xscale",t),this.__updateTransform(),this.inited&&this.__updateBounds()),I},n.prototype.set_yscale=function(t){return t!==this.yscale&&(this.setAndFire("yscale",t),this.__updateTransform(),this.inited&&this.__updateBounds()),I},n.prototype.set_rotation=function(t){return t!==this.rotation&&(this.setAndFire("rotation",t),this.__updateTransform(),this.inited&&this.__updateBounds()),I},n.prototype.set_z=function(t){return t!==this.z&&(this.sprite.setAttribute("z",t),this.setAndFire("z",t),this.__updateTransform()),I},n.prototype.set_xanchor=function(t){return(null==t||""===t||"undefined"===t)&&(t="center"),t!==this.xanchor&&(this.setAndFire("xanchor",t),this.__updateTransform(),this.inited&&this.__updateBounds()),I},n.prototype.set_yanchor=function(t){return(null==t||""===t||"undefined"===t)&&(t="center"),t!==this.yanchor&&(this.setAndFire("yanchor",t),this.__updateTransform(),this.inited&&this.__updateBounds()),I},n.prototype.set_zanchor=function(t){return(null==t||""===t)&&(t=0),t!==this.zanchor&&(this.setAndFire("zanchor",t),this.__updateTransform()),I},n.prototype.set_skin=function(t){return t!==this.skin&&(this.skin=t,this.reskin(),this.setAndFire("skin",t)),I},n.prototype.attachSkinListener=function(){return this.$skinlistner?void 0:(this.$skinlistner=!0,this.listenTo(this,"subviewAdded",function(t){return t.attachSkinListener(),t.reskin()}))},n.prototype.reskin=function(){var t,e,n,i,r,s;if(this.attachSkinListener(),!window.dr.skins)return void console.log("<skin> hasn't been initialized yet",this);if(this.skin){for(n=this.skin.split(/[^A-Za-z0-9_-]+/),s=[],i=0,r=n.length;r>i;i++)e=n[i],s.push((t=window.dr.skins[e])?t.applyTo(this):console.log("Cannot apply skin:",e));return s}return this.parent&&this.parent.reskin?this.parent.reskin():void 0},n.prototype.moveToFront=function(){var t,e,n,i;for(i=this.parent.subviews,e=0,n=i.length;n>e;e++)t=i[e],t.z||t.setAttribute("z",0),this.z<=t.z&&(this.z=t.z+1);return this.__updateTransform()},n.prototype.moveToBack=function(){var t,e,n,i;for(i=this.parent.subviews,e=0,n=i.length;n>e;e++)t=i[e],t.z||t.setAttribute("z",0),this.z>=t.z&&(this.z=t.z-1);return this.__updateTransform()},n.prototype.moveInFrontOf=function(t){return t?(t.z||t.setAttribute("z",0),this.z=t.z+1,this.__updateTransform()):void 0},n.prototype.moveBehind=function(t){return t?(t.z||t.setAttribute("z",0),this.z=t.z-1,this.__updateTransform()):void 0},n.prototype.doSubnodeAdded=function(t){return t instanceof n?(t.__updateBounds(),this.sendEvent("subviewAdded",t),this.doSubviewAdded(t)):t instanceof d?this.doLayoutAdded(t):void 0},n.prototype.doSubnodeRemoved=function(t){return t instanceof n?(this.sendEvent("subviewRemoved",t),this.doSubviewRemoved(t)):t instanceof d?this.doLayoutRemoved(t):void 0},n.prototype.doSubviewAdded=function(){},n.prototype.doSubviewRemoved=function(){},n.prototype.doLayoutAdded=function(){},n.prototype.doLayoutRemoved=function(){},n.prototype.getLayoutHint=function(t,e){var n,i;if(i=this.layouthint){if(n=i[t+"/"+e],null!=n)return n;if(n=i[e],null!=n)return n;if(n=i["*/"+e],null!=n)return n}},n.prototype.getAbsolute=function(){return this.sprite.getAbsolute()},n}(f)}.call(this),Y=[],V=function(t){var e,n;return Y=Y.concat(t),e=t.join("\n"),n=document.createElement("pre"),n.setAttribute("class","warnings"),n.textContent=e,document.body.insertBefore(n,document.body.firstChild),console.error(e)},W=["handler","method","attribute","setter","include"],O=/^on(.+)/,q="-",F=function(){var t,e,r,o,u,l,h,p,c,g,v,y,m,x;return u=function(t){var e,n,i,r;for(e={},i=0,r=t.length;r>i;i++)n=t[i],e[n.name]=n.value;return e},m=function(t){var e;return e=document.createEvent("Event"),e.initEvent("dreeminit",!0,!0),window.dispatchEvent(e),$(t).addClass("dreeminited")},g=function(t){return B=!0,t.style.visibility="hidden",o(t,function(){return t.style.visibility=null,c(t),K(),m(t)})},l=function(t){var e,n,i,r,s;for(r=t.childNodes,s=[],n=0,i=r.length;i>n;n++)e=r[n],1===e.nodeType&&s.push(e);return s},o=function(e,r){var o,u,l,h,p,c,g,v,y,m,w,x,k,A,S,T,E;return m=$(e),v={},S=[],T=!1,u=[],A=function(t,e,n){var i,r;if(!(t in v))return v[t]=!0,u.push(t),T?(S.push(t,n),t):(i=function(t,e,n){var i;return null==n&&(n="failed to load scriptinclude "+t),T=t,i=document.createElement("script"),i.type="text/javascript",$("head").append(i),i.onload=e,i.onerror=function(t){return console.error(n,t),e()},i.src=t},r=function(){return T=!1,0===S.length?e():i(S.shift(),r,S.shift())},i(t,r,n))},y={},p=[],l={},w=function(t,e){var n;if(!(t in l))return l[t]=e,u.push(t),n=$.get(t),n.url=t,n.el=e,p.push(n)},k=function(t,e){var n,i,r,s,o;if(null==e&&(e={}),t.attributes["with"]&&null!=t.attributes["with"].value){for(s=t.attributes["with"].value.split(","),o=[],i=0,r=s.length;r>i;i++)n=s[i],o.push(e[n.trim()]=t);return o}},g=function(e){var n,i,r,o,a,u,h,d;for(null==e&&(e={}),u=m.find("*"),o=0,a=u.length;a>o;o++)n=u[o],i=n.localName,"class"===i?(n.attributes["extends"]&&(e[n.attributes["extends"].value]=n),k(n,e),y[null!=(h=n.attributes.name)?h.value:void 0]=!0):"replicator"===i?(e[i]=n,e[n.attributes.classname.value]=n,k(n,e)):(d=n.parentNode.localName,s.call(W,d)<0&&(e[i]=n,k(n,e)));r={};for(i in e)n=e[i],i in dr||i in l||s.call(W,i)>=0||i in y||t[i]||(r[i]=n);return r},c=function(t){var e,n,i,r,s;for(null==t&&(t={}),s=m.find("include"),i=0,r=s.length;r>i;i++)e=s[i],n=e.attributes.href.value,e.parentNode.removeChild(e),t[n]=e;return t},x=function(t){var e,r,s;l.skin||(l.skin=!0,w("/classes/skin.dre")),s=c();for(r in s)e=s[r],w(r,e);return $.when.apply($,p).done(function(){var s,o,u,h,v,y,k,S,T,E;for(s=1<=arguments.length?n.call(arguments,0):[],1===p.length&&(s=[s]),p=[],h=/<[\/]*library>/gi,k=0,S=s.length;S>k;k++)y=s[k],u=y[0].replace(h,""),m.prepend(u);T=g();for(v in T)e=T[v],l[v]=!0,v&&w("/classes/"+v.split(q).join("/")+".dre",e);$.when.apply($,p).done(function(){var s,o,u,l,h;for(s=1<=arguments.length?n.call(arguments,0):[],1===p.length&&(s=[s]),p=[],l=0,h=s.length;h>l;l++)y=s[l],m.prepend(y[0]),m.contents().each(function(){return this.nodeType===i?$(this).remove():void 0});return o=g(c()),Object.keys(o).length>0?void x(t):(u="/lib/one_base.js",$.ajax({dataType:"script",cache:!0,url:u}).done(function(){var n,i,s,o;for(ONE.base_.call(a.prototype),a.prototype.enumfalse(a.prototype.keys()),f.prototype.enumfalse(f.prototype.keys()),_.prototype.enumfalse(_.prototype.keys()),d.prototype.enumfalse(d.prototype.keys()),b.prototype.enumfalse(b.prototype.keys()),A("/lib/animator.js",t,"Missing /lib/animator.js"),s=m.find("[scriptincludes]"),o=[],n=0,i=s.length;i>n;n++)e=s[n],o.push(function(){var n,i,s,o,a;for(s=e.attributes.scriptincludes.value.split(","),a=[],n=0,i=s.length;i>n;n++)r=s[n],a.push(A(r.trim(),t,null!=(o=e.attributes.scriptincludeserror)?o.value.toString():void 0));return a}());return o}).fail(function(){return console.warn("failed to load "+u)}))}).fail(function(){var t,e,i;for(t=1<=arguments.length?n.call(arguments,0):[],1===t.length&&(t=[t]),e=0,i=t.length;i>e;e++)y=t[e],V(["failed to load "+y.url+" for element "+y.el.outerHTML])}),E=[];for(o in l)E.push(l[o]=!0);return E}).fail(function(){var t,e,i,r;for(t=1<=arguments.length?n.call(arguments,0):[],1===t.length&&(t=[t]),i=0,r=t.length;r>i;i++)e=t[i],V(["failed to load "+e.url+" for element "+e.el.outerHTML])})},o=["/primus/primus.io.js"],h=function(){var t;return u.push(window.location.pathname),u.push("/core/layout.coffee"),t=u.filter(function(t){return s.call(o,t)<0?!0:void 0}),$.ajax({url:"/watchfile/",datatype:"text",data:{url:t},success:function(e){return s.call(t,e)>=0?window.location.reload():void 0}}).done(function(){return h()})},E=function(){return $.ajax({url:"/validate/",data:{url:window.location.pathname},success:function(t){return t.length&&V(t),h()},error:function(){return console.warn("Validation requires the Teem server")}}).always(r)},x(X?r:E)},t={a:!0,abbr:!0,address:!0,area:!0,article:!0,aside:!0,audio:!0,b:!0,base:!0,bdi:!0,bdo:!0,blockquote:!0,body:!0,br:!0,button:!0,canvas:!0,caption:!0,cite:!0,code:!0,col:!0,colgroup:!0,command:!0,datalist:!0,dd:!0,del:!0,details:!0,dfn:!0,div:!0,dl:!0,dt:!0,em:!0,embed:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,head:!0,header:!0,hgroup:!0,hr:!0,html:!0,i:!0,iframe:!0,img:!0,image:!0,input:!0,ins:!0,kbd:!0,keygen:!0,label:!0,legend:!0,li:!0,link:!0,map:!0,mark:!0,menu:!0,meta:!0,meter:!0,nav:!0,noscript:!0,object:!0,ol:!0,optgroup:!0,option:!0,output:!0,p:!0,param:!0,pre:!0,progress:!0,q:!0,rp:!0,rt:!0,ruby:!0,s:!0,samp:!0,script:!0,section:!0,select:!0,small:!0,source:!0,span:!0,strong:!0,style:!0,sub:!0,summary:!0,sup:!0,table:!0,tbody:!0,td:!0,textarea:!0,tfoot:!0,th:!0,thead:!0,time:!0,title:!0,tr:!0,track:!0,u:!0,ul:!0,"var":!0,video:!0,wbr:!0},y={"class":{name:1},method:{name:1},setter:{name:1},handler:{event:1},attribute:{name:1,type:1,value:1},dataset:{name:1},replicator:{classname:1}},e=function(t,e,n,i){var r,s;if(t in y)for(r in y[t])r in e||(s=""+t+"."+r+" must be defined on "+n.outerHTML,i&&(s+=" inside "+i.outerHTML),V([s]));return s},c=function(n,i){var r,o,a,l,h,d,p,f,g,v,y,b,_,m,x,k;if(!n.$init){if(n.$init=!0,b=n.localName,!b in dr)return void(t[b]||console.warn("could not find class for tag",b,n));if(t[b])return void("input"!==b&&console.warn("refusing to create a class that would overwrite the builtin tag",b));for(o=u(n.attributes),e(b,o,n),o.$tagname=b,_=0,x=j.length;x>_;_++)d=j[_],p="on"+d,p in o&&(o.clickable!==!1&&(o.clickable=!0),n.removeAttribute(p));for(r in o)O.test(r)&&n.removeAttribute(r);if(null==i&&(i=n.parentNode),null!=i&&(o.parent=i),v=b.lastIndexOf("state"),g=v>-1&&v===b.length-5,f="class"===b,f||g||F.processSpecialTags(n,o,o.type),h=F.getChildElements(n),o.$skiponinit=y=h.length>0,"function"!=typeof dr[b])return void V(["Unrecognized class "+b+" "+n.outerHTML]);if(i=new dr[b](n,o,!0),h.length>0&&!f&&!g){if(!dr[b].skipinitchildren)for(h=function(){var t,e,i,r,o;for(i=F.getChildElements(n),o=[],t=0,e=i.length;e>t;t++)l=i[t],r=l.localName,s.call(W,r)<0&&o.push(l);return o}(),m=0,k=h.length;k>m;m++)l=h[m],c(l,i);i.inited||(a=function(){i.inited||(i._bindHandlers(!0),i.initialize())},w(a))}}},x=function(){var t,e,n,i,r,s;return r=document.createElement("style"),r.type="text/css",n=["position:absolute","pointer-events:none","padding:0","margin:0","box-sizing:border-box","border-color:transparent","border-style:solid","border-width:0"],i=["white-space:nowrap","padding:0","margin:0","text-decoration:none","font-family:mission-gothic, 'Helvetica Neue', Helvetica, Arial, sans-serif","font-size:20px"],e=["border:none","outline:none","background-color:transparent","resize:none"],t=["-webkit-touch-callout:none","-webkit-user-select:none","-khtml-user-select:none","-moz-user-select:none","-ms-user-select:none","user-select:none"],s=["font-size:14px","background-color:pink","margin:0"],r.innerHTML=".sprite{"+n.join(";")+"}.sprite-text{"+i.join(";")+"}.sprite-inputtext{"+e.join(";")+"}.noselect{"+t.join(";")+"}.warnings{"+s.join(";")+"}.noscrollbar::-webkit-scrollbar{display:none;}.hidden{display:none}method,handler,setter,class,node,dataset{display:none}",document.getElementsByTagName("head")[0].appendChild(r)},p=function(t){var e,n,i;for(null==t&&(t=$("view").not("view view")),n=0,i=t.length;i>n;n++)e=t[n],g(e)},h=function(t){var e,n,i,r,s,o;for(n=document.createElement("div"),n.innerHTML=t,i="",o=n.childNodes,r=0,s=o.length;s>r;r++){if(e=o[r],null==e.nodeValue||3!==e.nodeType&&8!==e.nodeType)return;i+=e.nodeValue}return i},v=function(t,n,i){var r,o,a,l,d,p,c,f,g,v,y,b,_,m;for(null==n.$types&&(n.$types={}),null==n.$methods&&(n.$methods={}),null==n.$handlers&&(n.$handlers=[]),l=function(){var e,n,i,r,o;for(i=F.getChildElements(t),o=[],e=0,n=i.length;n>e;e++)a=i[e],r=a.localName,s.call(W,r)>=0&&o.push(a);return o}(),y=0,b=l.length;b>y;y++)switch(a=l[y],o=u(a.attributes),f=a.localName,r=(null!=(_=o.args)?_:"").split(),c=h(a.innerHTML),null==c&&console.warn("Invalid tag",p,a),g=null!=(m=o.type)?m:i,p=o.name,e(f,o,a,t),f){case"handler":d={name:p,ev:o.event,script:S.transform(c,g),args:r,reference:o.reference,method:o.method},n.$handlers.push(d);break;case"method":case"setter":"setter"===f&&(p="set_"+p.toLowerCase()),null==(v=n.$methods)[p]&&(v[p]=[]),n.$methods[p].push({method:S.transform(c,g),args:r,allocation:o.allocation});break;case"attribute":p=p.toLowerCase(),n[p]=o.value,n.$types[p]=o.type}return l},r={initAllElements:p,initElement:c,processSpecialTags:v,writeCSS:x,getChildElements:l}}(),b=function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},i=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};return t=function(t){function e(t,e){var n,r,s,o,a,u,l,h,d,p,c,f,g,v,y,b;for(null==e&&(e={}),this.skipattributes=["parent","types","applyattributes","applied","skipattributes","stateattributes","subnodes"],this.subnodes=[],this.stateattributes=e,this.applyattributes={},this.applied=!1,r=e.type,l=F.processSpecialTags(t,e,r),u=t.innerHTML.trim(),c=0,g=l.length;g>c;c++)n=l[c],n.parentNode.removeChild(n);this.instancebody=t.innerHTML.trim(),u&&(t.innerHTML=u),this.types=null!=(y=e.$types)?y:{},this.setAttribute("parent",e.parent),null==(d=this.parent).states&&(d.states=[]),null==(p=this.parent.states).origmethods&&(p.origmethods={}),this.parent.states.push(this),this.parent.sendEvent("states",this.parent.states),this.statemethods=e.$methods;for(a in e)h=e[a],i.call(this.skipattributes,a)>=0||"$"===a.charAt(0)||("name"!==a&&(this.applyattributes[a]=h),this.setAttribute(a,h));for(e.applied&&this.bindAttribute("applied",e.applied,"state"),b=e.$handlers,f=0,v=b.length;v>f;f++)o=b[f],"onapplied"===o.ev&&(this.installHandlers([o],"state",this),this._bindHandlers());s=function(t){return function(){return t.constraints&&t._bindConstraints(),t.events&&t.skipattributes.push("events"),t.enumfalse(t.skipattributes)}}(this),w(s),t&&(t.$view=this),this.children=[],this.initialize(!0)}return n(e,t),e.prototype.set_applied=function(t){var e,n,i;if(this.parent&&this.applied!==t){n=this.parent.states.origmethods;for(e in n)this.parent[e]=n[e];t?this._apply():this._remove();for(e in this.applyattributes)i=this.parent[e],delete this.parent[e],this.parent.setAttribute(e,i,!0)}return t},e.prototype._apply=function(){var t,e,n,r,s,o,a,u,l,h,d,p,c,f,g,v;if(!this.applied){this.parent.learn(this),o=this.parent.states.origmethods;for(s in this.statemethods)s in this.parent&&i.call(o,s)<0&&(o[s]=this.parent[s]);for(v=this.parent.states,h=0,c=v.length;c>h;h++)u=v[h],(u.applied||u===this)&&this.parent.installMethods(u.statemethods,this.parent.$tagname,this.parent,this.parent);if(this.instancebody){for(a=this.parent.sprite.el,e=F.getChildElements(a),d=0,f=e.length;f>d;d++)n=e[d],n.$view&&(n.$view=null);for(a.innerHTML+=this.instancebody,t=F.getChildElements(a),r=p=0,g=t.length;g>p;r=++p)n=t[r],r<e.length?(l=this.parent.subnodes[r],(null!=l?l.sprite:void 0)&&(l.sprite.el=n),n.$view=l):(F.initElement(n,this.parent),this.children.push(n.$view))}return this.stateattributes.$handlers?(this.parent.installHandlers(this.stateattributes.$handlers,this.parent.$tagname,this.parent),this.parent._bindHandlers()):void 0}},e.prototype._remove=function(){var t,e,n,i,r;if(this.applied){for(this.parent.forget(this);t=this.children.pop();)t.destroy();for(r=this.parent.states,n=0,i=r.length;i>n;n++)e=r[n],e.applied&&e!==this&&this.parent.installMethods(e.statemethods,this.parent.$tagname,this.parent,this.parent);return this.stateattributes.$handlers?this.parent.removeHandlers(this.stateattributes.$handlers,this.parent.$tagname,this.parent):void 0}},e}(f)}.call(this),o=function(){var t,e=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};return t=function(){function t(t,n){var r,s,o,a,u,l,h,d,p,c,f,g,v,y,b,_,m,x,A,S,$,T,E,L;null==n&&(n={}),f=n.name?n.name.toLowerCase():n.name,a=null!=n["extends"]?n["extends"]:n["extends"]="view",s=n.type,m="false"===n.initchildren,delete n.initchildren;for(h in z)delete n[h];for(L=t.childNodes,x=0,$=L.length;$>x;x++)r=L[x],null!=r&&r.nodeType===i&&r.parentNode.removeChild(r);for(_=F.processSpecialTags(t,n,s),v=t.innerHTML.trim(),A=0,T=_.length;T>A;A++)r=_[A],r.parentNode.removeChild(r);if(u=F.getChildElements(t).length>0,d=t.innerHTML.trim(),v&&(t.innerHTML=v),f in dr&&console.warn("overwriting class",f),dr[f]=p=function(t,i,s,o){var l,h,p,c,g,v,y,b,_;if(l=k(n),U(i,l),null==l.$instanceattributes&&(l.$instanceattributes=i),!(a in dr))return void console.warn("could not find class for tag",a);if("class"!==l.$tagname&&l.$tagname||(l.$tagname=f),l.$skiponinit=!0,l.$deferbindings=u,p=new dr[a](t,l,!0,!0),g=null!=(_=p.sprite)?_.el:void 0,t&&(g||t.setAttribute("class","hidden")),g&&(d&&(v=g.innerHTML.trim(),g.innerHTML=v?d+v:d),!o&&(h=function(){var t,n,i,s,o;for(i=F.getChildElements(g),o=[],t=0,n=i.length;n>t;t++)r=i[t],s=r.localName,e.call(W,s)<0&&o.push(r);return o}(),!m)))for(y=0,b=h.length;b>y;y++)r=h[y],F.initElement(r,p);return o||(c=function(){return p.inited?void 0:(p._bindHandlers(!0),p.initialize())},s?w(c):c()),p},f&&(b=f.split(q),c=b.length,c>1))for(o=dr,l=S=0,E=b.length;E>S;l=++S)y=b[l],l===c-1?o[y]=p:(g=o[y],g||(o[y]=g={}),o=g);p.skipinitchildren=m,p.classattributes=n}return t}()}.call(this),d=function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};return t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.construct=function(t,n){var i,r,s,o,a,u;if(null==n.$types&&(n.$types={}),n.$types.locked="boolean",null!=n.locked&&(i="true"===n.locked?!0:!1),this.locked=!0,this.subviews=[],e.__super__.construct.apply(this,arguments),this.listenTo(this.parent,"subviewAdded",this.addSubview.bind(this)),this.listenTo(this.parent,"subviewRemoved",this.removeSubview.bind(this)),this.listenTo(this.parent,"init",this.update.bind(this)),null==(o=this.parent).layouts&&(o.layouts=[]),this.parent.layouts.push(this),this.parent.sendEvent("layouts",this.parent.layouts),s=this.parent.subviews,s&&this.parent.inited)for(a=0,u=s.length;u>a;a++)r=s[a],this.addSubview(r);return this.locked=null!=i?i:!1,this.update()},e.prototype.destroy=function(t){return this.locked=!0,e.__super__.destroy.apply(this,arguments),t?void 0:this._removeFromParent("layouts")},e.prototype.addSubview=function(t){var e,n;return n=this,e=this.__ignoreFunc=function(){return-1===n.__removeSubview(this)?n.__addSubview(this):void 0},this.startMonitoringSubviewForIgnore(t,e),this.__addSubview(t)},e.prototype.__addSubview=function(t){return this.ignore(t)?void 0:(this.subviews.push(t),this.startMonitoringSubview(t),this.locked?void 0:this.update())},e.prototype.removeSubview=function(t){return this.stopMonitoringSubviewForIgnore(t,this.__ignoreFunc),this.ignore(t)?-1:this.__removeSubview(t)},e.prototype.__removeSubview=function(t){var e;return e=this.subviews.indexOf(t),-1!==e&&(this.stopMonitoringSubview(t),this.subviews.splice(e,1),this.locked||this.update()),e},e.prototype.startMonitoringSubviewForIgnore=function(t,e){return this.listenTo(t,"ignorelayout",e)},e.prototype.stopMonitoringSubviewForIgnore=function(t,e){return this.stopListening(t,"ignorelayout",e)},e.prototype.ignore=function(t){var e,n,i;return e=t.ignorelayout,"object"==typeof e?(n=this.name,n?(i=e[n],null!=i?i:e["*"]):e["*"]):e},e.prototype.startMonitoringSubview=function(){},e.prototype.startMonitoringAllSubviews=function(){var t,e,n;for(e=this.subviews,t=e.length,n=[];t;)n.push(this.startMonitoringSubview(e[--t]));return n},e.prototype.stopMonitoringSubview=function(){},e.prototype.stopMonitoringAllSubviews=function(){var t,e,n;for(e=this.subviews,t=e.length,n=[];t;)n.push(this.stopMonitoringSubview(e[--t]));return n},e.prototype.canUpdate=function(){return!this.locked&&this.parent.inited},e.prototype.update=function(){},e.prototype.set_locked=function(t){return this.locked!==t&&t===!1&&(this.locked=!1,this.update()),t},e}(f)}.call(this),t=function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};return t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.startMonitoringSubview=function(t){var e;return e=this.update.bind(this),"x"===this.axis?(this.listenTo(t,"x",e),this.listenTo(t,"width",e),this.listenTo(t,"boundsx",e),this.listenTo(t,"boundswidth",e)):(this.listenTo(t,"y",e),this.listenTo(t,"height",e),this.listenTo(t,"boundsy",e),this.listenTo(t,"boundsheight",e)),this.listenTo(t,"visible",e)},e.prototype.stopMonitoringSubview=function(t){var e;return e=this.update.bind(this),"x"===this.axis?(this.stopListening(t,"x",e),this.stopListening(t,"width",e),this.stopListening(t,"boundsx",e),this.stopListening(t,"boundswidth",e)):(this.stopListening(t,"y",e),this.stopListening(t,"height",e),this.stopListening(t,"boundsy",e),this.stopListening(t,"boundsheight",e)),this.stopListening(t,"visible",e)},e.prototype.update=function(){var t,e,n,i,r,s,o;if(!this.locked&&this.axis){if(this.locked=!0,s=this.subviews,t=s.length,n=Math.max,i=this.parent,e=0,"x"===this.axis){for(;t;)r=s[--t],this._skipX(r)||(e=n(e,r.boundsx+n(0,r.boundswidth)));o=e+i.__fullBorderPaddingWidth,i.width!==o&&(i.__noSpecialValueHandling=!0,i.setAttribute("width",o))}else{for(;t;)r=s[--t],this._skipY(r)||(e=n(e,r.boundsy+n(0,r.boundsheight)));o=e+i.__fullBorderPaddingHeight,i.height!==o&&(i.__noSpecialValueHandling=!0,i.setAttribute("height",o))}return this.locked=!1}},e.prototype._skipX=function(t){return!t.visible||null!=t.__percentFuncwidth||null!=t.__percentFuncx||null!=t.__alignFuncx&&!t.__alignFuncx.autoOk},e.prototype._skipY=function(t){return!t.visible||null!=t.__percentFuncheight||null!=t.__percentFuncy||null!=t.__alignFuncy&&!t.__alignFuncy.autoOk},e}(d)}.call(this),g=function(){var t;return t=function(){function t(t){null==t&&(t=[]),this._boundingBox=null,this.vectors=t}return t.prototype.degreesToRadians=function(t){return t*Math.PI/180},t.prototype.radiansToDegrees=function(t){return 180*t/Math.PI},t.prototype.translate=function(t,e){var n,i;for(i=this.vectors,n=i.length;n;)i[--n]+=e,i[--n]+=t;return this._boundingBox=null,this},t.prototype.rotate=function(t){var e,n,i,r,s,o,a;for(t=this.degreesToRadians(t),e=Math.cos(t),r=Math.sin(t),s=this.vectors,i=s.length,n=0;i>n;)o=s[n]*e-s[n+1]*r,a=s[n]*r+s[n+1]*e,s[n++]=o,s[n++]=a;return this._boundingBox=null,this},t.prototype.scale=function(t,e){var n,i;for(i=this.vectors,n=i.length;n;)i[--n]*=e,i[--n]*=t;return this._boundingBox=null,this},t.prototype.transformAroundOrigin=function(t,e,n,i,r){return this.translate(-i,-r).rotate(n).scale(t,e).translate(i,r)},t.prototype.getBoundingBox=function(){var t,e,n,i,r,s,o,a;if(this._boundingBox)return this._boundingBox;if(s=this.vectors,t=s.length,t>=2){for(r=n=s[--t],i=e=s[--t];t;)a=s[--t],o=s[--t],r=Math.min(a,r),n=Math.max(a,n),i=Math.min(o,i),e=Math.max(o,e);return this._boundingBox={x:i,y:r,width:e-i,height:n-r}}return this._boundingBox=null},t}()}.call(this),y=function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};return t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype.register=function(){return e.__super__.register.apply(this,arguments),this.startEventTest()?this.startEvent():void 0},e.prototype.unregister=function(){return e.__super__.unregister.apply(this,arguments),this.startEventTest()?void 0:this.stopEvent()},e.prototype.startEvent=function(){return this.eventStarted?void 0:this.eventStarted=!0},e.prototype.stopEvent=function(){return this.eventStarted?this.eventStarted=!1:void 0},e}(a)}.call(this),D=Date.now(),C=function(){var t,e,n,i;return e=x.raf,e||(e=function(){return function(t){var e;return e=function(){return t(Date.now()-D)},window.setTimeout(e,1e3/60)}}()),i=!1,n=[],t=function(t){var e;for(e in n)n[e]&&(n[e](t),n[e]=null);return i=!1},function(r,s){return i||(e(t),i=!0),n[r]=s}}(),w=function(){var t,e;return e=[],t=function(n){var i,r,s,o;for(r=e,e=[],s=0,o=r.length;o>s;s++)(i=r[s])(n);e.length&&setTimeout(function(){return C(2,t)},0)},x.raf?function(n){e.push(n),C(2,t)}:function(t){setTimeout(function(){return t(Date.now()-D)},0)}}(),l=function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};return t=function(t){function n(){return this.sender=e(this.sender,this),this.startEvent=e(this.startEvent,this),n.__super__.constructor.apply(this,arguments)}return i(n,t),n.prototype.startEventTest=function(){var t,e;return t=null!=(e=this.events.idle)?e.length:void 0,t?t:void 0},n.prototype.startEvent=function(){n.__super__.startEvent.apply(this,arguments),C(1,this.sender)},n.prototype.sender=function(t){return this.sendEvent("idle",t),setTimeout(function(t){return function(){return C(1,t.sender)}}(this),0)},n.prototype.callOnIdle=function(t){return w(t)},n}(y)}.call(this),j=["click","mouseover","mouseout","mousedown","mouseup"],c=function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};return t=function(t){function n(){this.sender=e(this.sender,this),this.handle=e(this.handle,this),this.touchHandler=e(this.touchHandler,this),this.x=0,this.y=0,this.docSelector=$(document),this.docSelector.on(j.join(" "),this.handle),this.docSelector.on("mousemove",this.handle).one("mouseout",this.stopEvent),x.touch&&(document.addEventListener("touchstart",this.touchHandler,!0),document.addEventListener("touchmove",this.touchHandler,!0),document.addEventListener("touchend",this.touchHandler,!0),document.addEventListener("touchcancel",this.touchHandler,!0))
}var r,s,o;return i(n,t),o=function(t){return t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,!1},n.prototype.startEventTest=function(){var t,e,n;return(null!=(t=this.events.mousemove)?t.length:void 0)||(null!=(e=this.events.x)?e.length:void 0)||(null!=(n=this.events.y)?n.length:void 0)},n.prototype.sendMouseEvent=function(t,e){var n;return n=document.createEvent("MouseEvent"),n.initMouseEvent(t,!0,!0,window,1,e.pageX,e.pageY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n),e.target.$view&&"inputtext"!==e.target.$view.$tagname?o(event):void 0},r=null,s=null,n.prototype.touchHandler=function(t){var e,n,i;switch(i=t.changedTouches,e=i[0],t.type){case"touchstart":return this.sendMouseEvent("mouseover",e),this.sendMouseEvent("mousedown",e),r=e.target;case"touchmove":return n=document.elementFromPoint(e.pageX-window.pageXOffset,e.pageY-window.pageYOffset),n&&n.$view&&(s&&s!==n&&this.handle({target:s,type:"mouseout"}),s=n,this.handle({target:n,type:"mouseover"})),this.sendMouseEvent("mousemove",e);case"touchend":if(this.sendMouseEvent("mouseup",e),r===e.target)return this.sendMouseEvent("click",e),r=null}},n.prototype.handle=function(t){var e,n;return n=t.target.$view,e=t.type,n&&"mousedown"===e&&(this._lastMouseDown=n,"inputtext"!==n.$tagname&&o(t)),"mouseup"===e&&this._lastMouseDown&&this._lastMouseDown!==n?(this.sendEvent("mouseup",this._lastMouseDown),this._lastMouseDown.sendEvent("mouseup",this._lastMouseDown),this.sendEvent("mouseupoutside",this._lastMouseDown),this._lastMouseDown.sendEvent("mouseupoutside",this._lastMouseDown),void(this._lastMouseDown=null)):(n&&n.sendEvent(e,n),this.x=t.pageX,this.y=t.pageY,void(this.eventStarted&&"mousemove"===e?C(0,this.sender):this.sendEvent(e,n)))},n.prototype.sender=function(){return this.sendEvent("mousemove",{x:this.x,y:this.y}),this.sendEvent("x",this.x),this.sendEvent("y",this.y)},n.prototype.handleDocEvent=function(t){return t&&t.target!==document?void 0:this.eventStarted?this.docSelector.on("mousemove",this.handle).one("mouseout",this.stopEvent):this.docSelector.on("mousemove",this.handle).one("mouseout",this.startEvent)},n}(y)}.call(this),m=function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};return t=function(t){function n(){this.handle=e(this.handle,this);var t,n,i;window.addEventListener("resize",this.handle,!1),this.visible=!0,null!=document.hidden?(n="hidden",i="visibilitychange"):null!=document.mozHidden?(n="mozHidden",i="mozvisibilitychange"):null!=document.msHidden?(n="msHidden",i="msvisibilitychange"):null!=document.webkitHidden&&(n="webkitHidden",i="webkitvisibilitychange"),t=function(t){return function(){return t.visible=document[n],t.sendEvent("visible",t.visible)}}(this),document.addEventListener(i,t,!1),this.handle()}return i(n,t),n.prototype.startEventTest=function(){var t,e;return(null!=(t=this.events.width)?t.length:void 0)||(null!=(e=this.events.height)?e.length:void 0)},n.prototype.handle=function(){this.width=window.innerWidth,this.sendEvent("width",this.width),this.height=window.innerHeight,this.sendEvent("height",this.height)},n}(y)}.call(this),h=function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,i=function(t,e){function i(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};return t=function(t){function n(){this.handle=e(this.handle,this),this.keys={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},$(document).on("select change keyup keydown",this.handle)}return i(n,t),n.prototype.handle=function(t){var e,n,i;n=t.target.$view,i=t.type;for(e in this.keys)this.keys[e]=t[e];return this.keys.type=i,n&&n.sendEvent(i,this.keys),"select"!==i&&"change"!==i?(this.sendEvent(i,this.keys),this.sendEvent("keys",this.keys)):void 0},n}(a)}.call(this),window.onerror=function(t){return V([""+t.toString()+". Try running in debug mode for more info. "+window.location.href+(R?"&":"?")+"debug"])},H={view:_,"class":o,node:f,mouse:new c,keyboard:new h,window:new m,layout:d,idle:new l,state:b,_noop:I,initElements:F.initAllElements,writeCSS:F.writeCSS,initConstraints:K}}(),dr.writeCSS(),$(window).on("load",function(){return dr.initElements(),t(!0)})}).call(this);